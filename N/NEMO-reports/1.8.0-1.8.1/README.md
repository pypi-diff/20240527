# Comparing `tmp/NEMO_reports-1.8.0-py3-none-any.whl.zip` & `tmp/NEMO_reports-1.8.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,41 +1,41 @@
-Zip file size: 52318 bytes, number of entries: 39
--rw-r--r--  2.0 unx        0 b- defN 24-May-25 12:48 NEMO_reports/__init__.py
--rw-r--r--  2.0 unx       41 b- defN 24-May-25 12:48 NEMO_reports/app_settings.py
--rw-r--r--  2.0 unx      486 b- defN 24-May-25 12:48 NEMO_reports/apps.py
--rw-r--r--  2.0 unx     1732 b- defN 24-May-25 12:48 NEMO_reports/customizations.py
--rw-r--r--  2.0 unx      348 b- defN 24-May-25 12:48 NEMO_reports/models.py
--rw-r--r--  2.0 unx     1620 b- defN 24-May-25 12:48 NEMO_reports/urls.py
--rw-rw-rw-  2.0 unx     1264 b- defN 24-May-25 12:48 NEMO_reports/migrations/0001_initial.py
--rw-r--r--  2.0 unx        0 b- defN 24-May-25 12:48 NEMO_reports/migrations/__init__.py
--rw-rw-rw-  2.0 unx      243 b- defN 24-May-25 12:48 NEMO_reports/static/NEMO_reports/NEMO_reports.css
--rw-rw-rw-  2.0 unx     7659 b- defN 24-May-25 12:48 NEMO_reports/static/NEMO_reports/daterangepicker.css
--rw-rw-rw-  2.0 unx    66305 b- defN 24-May-25 12:48 NEMO_reports/static/NEMO_reports/daterangepicker.js
--rw-rw-rw-  2.0 unx     3603 b- defN 24-May-25 12:48 NEMO_reports/templates/NEMO_reports/report_active_users.html
--rw-rw-rw-  2.0 unx     9524 b- defN 24-May-25 12:48 NEMO_reports/templates/NEMO_reports/report_base.html
--rw-rw-rw-  2.0 unx     2557 b- defN 24-May-25 12:48 NEMO_reports/templates/NEMO_reports/report_facility_usage.html
--rw-rw-rw-  2.0 unx     4174 b- defN 24-May-25 12:48 NEMO_reports/templates/NEMO_reports/report_new_users.html
--rw-rw-rw-  2.0 unx     1049 b- defN 24-May-25 12:48 NEMO_reports/templates/NEMO_reports/reports.html
--rw-rw-rw-  2.0 unx      287 b- defN 24-May-25 12:48 NEMO_reports/templates/base/navbar.html
--rw-rw-rw-  2.0 unx      134 b- defN 24-May-25 12:48 NEMO_reports/templates/base/navbar_reports.html
--rw-rw-rw-  2.0 unx     7129 b- defN 24-May-25 12:48 NEMO_reports/templates/customizations/customizations_reports.html
--rw-r--r--  2.0 unx        0 b- defN 24-May-25 12:48 NEMO_reports/templatetags/__init__.py
--rw-r--r--  2.0 unx      308 b- defN 24-May-25 12:48 NEMO_reports/templatetags/reports_tags.py
--rw-r--r--  2.0 unx        0 b- defN 24-May-25 12:48 NEMO_reports/tests/__init__.py
--rw-r--r--  2.0 unx     2863 b- defN 24-May-25 12:48 NEMO_reports/tests/test_settings.py
--rw-r--r--  2.0 unx      257 b- defN 24-May-25 12:48 NEMO_reports/tests/test_settings_with_billing.py
--rw-r--r--  2.0 unx      256 b- defN 24-May-25 12:48 NEMO_reports/tests/test_utilities.py
--rw-r--r--  2.0 unx        0 b- defN 24-May-25 12:48 NEMO_reports/tests/test_reports/__init__.py
--rw-r--r--  2.0 unx     3749 b- defN 24-May-25 12:48 NEMO_reports/tests/test_reports/test_reports.py
--rw-r--r--  2.0 unx        0 b- defN 24-May-25 12:48 NEMO_reports/views/__init__.py
--rw-r--r--  2.0 unx    19212 b- defN 24-May-25 12:48 NEMO_reports/views/reporting.py
--rw-r--r--  2.0 unx    15173 b- defN 24-May-25 12:48 NEMO_reports/views/reporting_facilily_usage.py
--rw-r--r--  2.0 unx    12326 b- defN 24-May-25 12:48 NEMO_reports/views/reporting_invoice_charges.py
--rw-r--r--  2.0 unx    16322 b- defN 24-May-25 12:48 NEMO_reports/views/reporting_invoice_item_charges.py
--rw-r--r--  2.0 unx    24972 b- defN 24-May-25 12:48 NEMO_reports/views/reporting_new_user_activities.py
--rw-r--r--  2.0 unx    15577 b- defN 24-May-25 12:48 NEMO_reports/views/reporting_unique_user_prj_acc.py
--rw-rw-rw-  2.0 unx     1074 b- defN 24-May-25 12:48 NEMO_reports-1.8.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     2116 b- defN 24-May-25 12:48 NEMO_reports-1.8.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-May-25 12:48 NEMO_reports-1.8.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       13 b- defN 24-May-25 12:48 NEMO_reports-1.8.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3753 b- defN 24-May-25 12:48 NEMO_reports-1.8.0.dist-info/RECORD
-39 files, 226218 bytes uncompressed, 46114 bytes compressed:  79.6%
+Zip file size: 53767 bytes, number of entries: 39
+-rw-r--r--  2.0 unx        0 b- defN 24-May-26 22:46 NEMO_reports/__init__.py
+-rw-r--r--  2.0 unx       41 b- defN 24-May-26 22:46 NEMO_reports/app_settings.py
+-rw-r--r--  2.0 unx      486 b- defN 24-May-26 22:46 NEMO_reports/apps.py
+-rw-r--r--  2.0 unx     1732 b- defN 24-May-26 22:46 NEMO_reports/customizations.py
+-rw-r--r--  2.0 unx      348 b- defN 24-May-26 22:46 NEMO_reports/models.py
+-rw-r--r--  2.0 unx     1834 b- defN 24-May-26 22:46 NEMO_reports/urls.py
+-rw-rw-rw-  2.0 unx     1264 b- defN 24-May-26 22:46 NEMO_reports/migrations/0001_initial.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-26 22:46 NEMO_reports/migrations/__init__.py
+-rw-rw-rw-  2.0 unx      243 b- defN 24-May-26 22:46 NEMO_reports/static/NEMO_reports/NEMO_reports.css
+-rw-rw-rw-  2.0 unx     7659 b- defN 24-May-26 22:46 NEMO_reports/static/NEMO_reports/daterangepicker.css
+-rw-rw-rw-  2.0 unx    66305 b- defN 24-May-26 22:46 NEMO_reports/static/NEMO_reports/daterangepicker.js
+-rw-rw-rw-  2.0 unx     3603 b- defN 24-May-26 22:46 NEMO_reports/templates/NEMO_reports/report_active_users.html
+-rw-rw-rw-  2.0 unx     9524 b- defN 24-May-26 22:46 NEMO_reports/templates/NEMO_reports/report_base.html
+-rw-rw-rw-  2.0 unx     7835 b- defN 24-May-26 22:46 NEMO_reports/templates/NEMO_reports/report_facility_usage.html
+-rw-rw-rw-  2.0 unx     4174 b- defN 24-May-26 22:46 NEMO_reports/templates/NEMO_reports/report_new_users.html
+-rw-rw-rw-  2.0 unx     1049 b- defN 24-May-26 22:46 NEMO_reports/templates/NEMO_reports/reports.html
+-rw-rw-rw-  2.0 unx      287 b- defN 24-May-26 22:46 NEMO_reports/templates/base/navbar.html
+-rw-rw-rw-  2.0 unx      134 b- defN 24-May-26 22:46 NEMO_reports/templates/base/navbar_reports.html
+-rw-rw-rw-  2.0 unx     7129 b- defN 24-May-26 22:46 NEMO_reports/templates/customizations/customizations_reports.html
+-rw-r--r--  2.0 unx        0 b- defN 24-May-26 22:46 NEMO_reports/templatetags/__init__.py
+-rw-r--r--  2.0 unx      308 b- defN 24-May-26 22:46 NEMO_reports/templatetags/reports_tags.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-26 22:46 NEMO_reports/tests/__init__.py
+-rw-r--r--  2.0 unx     2863 b- defN 24-May-26 22:46 NEMO_reports/tests/test_settings.py
+-rw-r--r--  2.0 unx      257 b- defN 24-May-26 22:46 NEMO_reports/tests/test_settings_with_billing.py
+-rw-r--r--  2.0 unx      263 b- defN 24-May-26 22:46 NEMO_reports/tests/test_utilities.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-26 22:46 NEMO_reports/tests/test_reports/__init__.py
+-rw-r--r--  2.0 unx     4060 b- defN 24-May-26 22:46 NEMO_reports/tests/test_reports/test_reports.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-26 22:46 NEMO_reports/views/__init__.py
+-rw-r--r--  2.0 unx    19435 b- defN 24-May-26 22:46 NEMO_reports/views/reporting.py
+-rw-r--r--  2.0 unx    17223 b- defN 24-May-26 22:46 NEMO_reports/views/reporting_facilily_usage.py
+-rw-r--r--  2.0 unx    12326 b- defN 24-May-26 22:46 NEMO_reports/views/reporting_invoice_charges.py
+-rw-r--r--  2.0 unx    16322 b- defN 24-May-26 22:46 NEMO_reports/views/reporting_invoice_item_charges.py
+-rw-r--r--  2.0 unx    24972 b- defN 24-May-26 22:46 NEMO_reports/views/reporting_new_user_activities.py
+-rw-r--r--  2.0 unx    15577 b- defN 24-May-26 22:46 NEMO_reports/views/reporting_unique_user_prj_acc.py
+-rw-rw-rw-  2.0 unx     1074 b- defN 24-May-26 22:46 NEMO_reports-1.8.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx     2116 b- defN 24-May-26 22:46 NEMO_reports-1.8.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-26 22:46 NEMO_reports-1.8.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       13 b- defN 24-May-26 22:46 NEMO_reports-1.8.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3753 b- defN 24-May-26 22:46 NEMO_reports-1.8.1.dist-info/RECORD
+39 files, 234301 bytes uncompressed, 47563 bytes compressed:  79.7%
```

## zipnote {}

```diff
@@ -96,23 +96,23 @@
 
 Filename: NEMO_reports/views/reporting_new_user_activities.py
 Comment: 
 
 Filename: NEMO_reports/views/reporting_unique_user_prj_acc.py
 Comment: 
 
-Filename: NEMO_reports-1.8.0.dist-info/LICENSE
+Filename: NEMO_reports-1.8.1.dist-info/LICENSE
 Comment: 
 
-Filename: NEMO_reports-1.8.0.dist-info/METADATA
+Filename: NEMO_reports-1.8.1.dist-info/METADATA
 Comment: 
 
-Filename: NEMO_reports-1.8.0.dist-info/WHEEL
+Filename: NEMO_reports-1.8.1.dist-info/WHEEL
 Comment: 
 
-Filename: NEMO_reports-1.8.0.dist-info/top_level.txt
+Filename: NEMO_reports-1.8.1.dist-info/top_level.txt
 Comment: 
 
-Filename: NEMO_reports-1.8.0.dist-info/RECORD
+Filename: NEMO_reports-1.8.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## NEMO_reports/urls.py

```diff
@@ -10,14 +10,19 @@
 urlpatterns = [
     path(
         "reporting/",
         include(
             [
                 path("", reporting.reports, name="reporting"),
                 path("facility_usage/", reporting_facilily_usage.facility_usage, name="reporting_facility_usage"),
+                path(
+                    "facility_usage/user_search",
+                    reporting_facilily_usage.user_search,
+                    name="reporting_facility_usage_user_search",
+                ),
                 path("unique_users/", reporting_unique_user_prj_acc.unique_users, name="reporting_unique_users"),
                 path("new_users/", reporting_new_user_activities.new_users, name="reporting_new_users"),
                 path(
                     "unique_user_project/",
                     reporting_unique_user_prj_acc.unique_user_and_project_combinations,
                     name="reporting_unique_user_project",
                 ),
```

## NEMO_reports/templates/NEMO_reports/report_facility_usage.html

```diff
@@ -45,8 +45,136 @@
                                {% if missed_reservations != "off" %}checked{% endif %}>
                         Missed reservations
                     </label>
                 </div>
             </div>
         </div>
     </div>
+    <div class="form-group">
+        <label class="col-sm-2 control-label" for="user_search">User:</label>
+        <div class="col-sm-5">
+            <input type="hidden" name="user_id" id="user_id" value="">
+            <input id="user_search"
+                   type="text"
+                   aria-label="Filter by user"
+                   placeholder="[Optional] Filter by user"
+                   class="form-control"
+                   value="{{ selected_user|default_if_none:'' }}"
+                   autofocus>
+            <input type="button"
+                   class="btn btn-default"
+                   style="display:none"
+                   id="user_search_button"
+                   onclick="purge_item('user')"
+                   value="user">
+        </div>
+    </div>
+    <div class="form-group" id="tool_search_container">
+        <label class="col-sm-2 control-label" for="tool_search">Tool:</label>
+        <div class="col-sm-5">
+            <input type="hidden" name="tool_id" id="tool_id" value="">
+            <input id="tool_search"
+                   type="text"
+                   aria-label="Filter by tool"
+                   placeholder="[Optional] Filter by tool"
+                   class="form-control"
+                   value="{{ selected_tool|default_if_none:'' }}"
+                   autofocus>
+            <input type="button"
+                   class="btn btn-default"
+                   style="display:none"
+                   id="tool_search_button"
+                   onclick="purge_item('tool')"
+                   value="tool">
+        </div>
+    </div>
+    <div class="form-group" id="area_search_container">
+        <label class="col-sm-2 control-label" for="area_search">Area:</label>
+        <div class="col-sm-5">
+            <input type="hidden" name="area_id" id="area_id" value="">
+            <input id="area_search"
+                   type="text"
+                   aria-label="Filter by area"
+                   placeholder="[Optional] Filter by area"
+                   class="form-control"
+                   value="{{ selected_area|default_if_none:'' }}"
+                   autofocus>
+            <input type="button"
+                   class="btn btn-default"
+                   style="display:none"
+                   id="area_search_button"
+                   onclick="purge_item('area')"
+                   value="area">
+        </div>
+    </div>
+    <script>
+        function check_charge_types()
+        {
+			let tool_search_container_jq = $("#tool_search_container");
+			let area_search_container_jq = $("#area_search_container");
+
+            if ($('#tool_usage:checked, #training:checked, #missed_reservations:checked').length > 0)
+            {
+                tool_search_container_jq.show();
+			}
+            else
+            {
+                purge_item('tool');
+                tool_search_container_jq.hide();
+			}
+            if ($('#area_access:checked, #missed_reservations:checked').length > 0)
+            {
+                area_search_container_jq.show();
+			}
+            else
+            {
+                purge_item('area');
+                area_search_container_jq.hide();
+			}
+		}
+        function get_item(jquery_event, search_selection, dataset_name)
+		{
+            $("#" + dataset_name + "_id").val(search_selection.id);
+            $("#" + dataset_name + "_search_button").val(search_selection.name).show();
+            $("#" + dataset_name + "_search").hide();
+            if (dataset_name === "tool")
+            {
+                $("#area_access").prop("checked", false);
+                $("#staff_charges").prop("checked", false);
+			}
+            if (dataset_name === "area")
+            {
+                $("#tool_usage").prop("checked", false);
+                $("#training").prop("checked", false);
+                $("#staff_charges").prop("checked", false);
+			}
+            check_charge_types();
+        }
+        function purge_item(item_type)
+		{
+            $("#" + item_type + "_search_button").hide();
+            $("#" + item_type + "_id").val('');
+            $("#" + item_type + "_search").typeahead('val', '').show().focus();
+        }
+		function on_load()
+		{
+			$("#user_search").autocomplete('user', get_item, '{% url 'reporting_facility_usage_user_search' %}', true).focus();
+			$("#tool_search").autocomplete('tool', get_item, {{ tool_list|json_search_base }}, true).focus();
+			$("#area_search").autocomplete('area', get_item, {{ area_list|json_search_base }}, true).focus();
+            if({{ selected_user.id|yesno:"true,false" }})
+            {
+                get_item(undefined, {"id": "{{ selected_user.id }}", "name": "{{ selected_user }}"}, "user");
+            }
+            if({{ selected_tool.id|yesno:"true,false" }})
+            {
+                get_item(undefined, {"id": "{{ selected_tool.id }}", "name": "{{ selected_tool }}"}, "tool");
+            }
+            if({{ selected_area.id|yesno:"true,false" }})
+            {
+                get_item(undefined, {"id": "{{ selected_area.id }}", "name": "{{ selected_area }}"}, "area");
+            }
+        }
+        window.addEventListener('load', on_load, true);
+        $("#tool_usage, #area_access, #staff_charges, #training, #missed_reservations").on("click", check_charge_types);
+	
+    </script>
 {% endblock %}
```

## NEMO_reports/tests/test_utilities.py

```diff
@@ -1,7 +1,7 @@
 from django.test import TestCase
 from requests import Response
 
 
-def test_response_is_landing_page(test_case: TestCase, response: Response):
+def test_response_is_url(test_case: TestCase, response: Response, url: str = "/"):
     test_case.assertEqual(response.status_code, 200)
-    test_case.assertEqual(response.request["PATH_INFO"], "/")
+    test_case.assertEqual(response.request["PATH_INFO"], url)
```

## NEMO_reports/tests/test_reports/test_reports.py

```diff
@@ -1,77 +1,72 @@
 from NEMO.models import Account, Project, User
+from django.contrib.auth.models import Permission
 from django.test import TestCase
 from django.urls import NoReverseMatch, reverse
 
 from NEMO_reports.customizations import ReportsCustomization
-from NEMO_reports.tests.test_utilities import test_response_is_landing_page
+from NEMO_reports.tests.test_utilities import test_response_is_url
 from NEMO_reports.views.reporting import billing_installed
 
 
 class TestReports(TestCase):
     def setUp(self):
         self.user, created = User.objects.get_or_create(
             username="test_user", first_name="Testy", last_name="McTester", badge_number=1
         )
         project = Project.objects.create(name="excluded_project", account=Account.objects.create(name="acct"))
         ReportsCustomization.set("reports_exclude_projects", project.id)
-        self.accounting, created = User.objects.get_or_create(
-            username="test_accounting",
-            first_name="Testy",
-            last_name="McTester",
-            badge_number=2,
-            is_accounting_officer=True,
-        )
 
     def test_master_url(self):
+        self.user: User = self.user
         self.client.force_login(self.user)
         response = self.client.get(reverse("reporting"), follow=True)
-        test_response_is_landing_page(self, response)
-        self.client.force_login(self.accounting)
+        test_response_is_url(self, response)
+        self.user.user_permissions.add(Permission.objects.get(codename="can_view_unique_users_report"))
         response = self.client.get(reverse("reporting"), follow=True)
-        self.assertEqual(response.status_code, 200)
+        test_response_is_url(self, response, reverse("reporting"))
 
     def test_unique_users_report(self):
         self.client.force_login(self.user)
         response = self.client.get(reverse("reporting_unique_users"), follow=True)
-        test_response_is_landing_page(self, response)
-        self.client.force_login(self.accounting)
+        test_response_is_url(self, response)
+        self.user.user_permissions.add(Permission.objects.get(codename="can_view_unique_users_report"))
         response = self.client.get(reverse("reporting_unique_users"), follow=True)
-        self.assertEqual(response.status_code, 200)
+        test_response_is_url(self, response, reverse("reporting_unique_users"))
 
     def test_unique_user_project_report(self):
         self.client.force_login(self.user)
         response = self.client.get(reverse("reporting_unique_user_project"), follow=True)
-        test_response_is_landing_page(self, response)
-        self.client.force_login(self.accounting)
+        test_response_is_url(self, response)
+        self.user.user_permissions.add(Permission.objects.get(codename="can_view_unique_user_project_report"))
         response = self.client.get(reverse("reporting_unique_user_project"), follow=True)
-        self.assertEqual(response.status_code, 200)
+        test_response_is_url(self, response, reverse("reporting_unique_user_project"))
 
     def test_unique_user_account_report(self):
         self.client.force_login(self.user)
         response = self.client.get(reverse("reporting_unique_user_account"), follow=True)
-        test_response_is_landing_page(self, response)
-        self.client.force_login(self.accounting)
+        test_response_is_url(self, response)
+        self.user.user_permissions.add(Permission.objects.get(codename="can_view_unique_user_account_report"))
         response = self.client.get(reverse("reporting_unique_user_account"), follow=True)
-        self.assertEqual(response.status_code, 200)
+        test_response_is_url(self, response, reverse("reporting_unique_user_account"))
 
     def test_invoice_charges_report(self):
         if billing_installed():
             self.client.force_login(self.user)
             response = self.client.get(reverse("reporting_invoice_charges"), follow=True)
-            test_response_is_landing_page(self, response)
-            self.client.force_login(self.accounting)
+            test_response_is_url(self, response)
+            self.user.user_permissions.add(Permission.objects.get(codename="can_view_invoice_charges_report"))
             response = self.client.get(reverse("reporting_invoice_charges"), follow=True)
-            self.assertEqual(response.status_code, 200)
+            test_response_is_url(self, response, reverse("reporting_invoice_charges"))
         else:
             self.assertRaises(NoReverseMatch, reverse, "reporting_invoice_charges")
 
     def test_invoice_item_charges_report(self):
         if billing_installed():
             self.client.force_login(self.user)
             response = self.client.get(reverse("reporting_invoice_item_charges"), follow=True)
-            test_response_is_landing_page(self, response)
-            self.client.force_login(self.accounting)
+            test_response_is_url(self, response)
+            self.user.user_permissions.add(Permission.objects.get(codename="can_view_invoice_item_charges_report"))
             response = self.client.get(reverse("reporting_invoice_item_charges"), follow=True)
-            self.assertEqual(response.status_code, 200)
+            test_response_is_url(self, response, reverse("reporting_invoice_item_charges"))
         else:
             self.assertRaises(NoReverseMatch, reverse, "reporting_invoice_item_charges")
```

## NEMO_reports/views/reporting.py

```diff
@@ -43,14 +43,16 @@
     "area_access",
     "training",
     "consumables",
     "staff_charges",
     "custom_charges",
     "missed_reservations",
 ]
+USER_PARAMETER = ["user_id"]
+ITEM_PARAMETER = ["tool_id", "area_id"]
 
 
 class BasicDisplayTableFormatted(BasicDisplayTable):
     def formatted_value(self, value, html: bool = False):
         if value is None:
             return ""
         if isinstance(value, Decimal):
@@ -149,15 +151,14 @@
     def get_bool(self, parameter_name: str, default=""):
         return (getattr(self, parameter_name, default) or default) == "on"
 
     def get_dict(self):
         return {parameter_name: getattr(self, parameter_name) for parameter_name in self.parameter_names}
 
 
-# Create your views here.
 @user_passes_test(lambda user: user.is_active and has_any_report_permissions(user))
 @require_GET
 def reports(request):
     report_dictionary = {
         key: report for key, report in get_report_dict().items() if request.user.has_perm(report["permission"])
     }
     return render(request, "NEMO_reports/reports.html", {"report_dict": report_dictionary})
@@ -236,14 +237,15 @@
 
 def usage_events(start, end) -> QuerySetType[UsageEvent]:
     queryset = UsageEvent.objects.filter(end__date__gte=start, end__date__lte=end)
     queryset = queryset.exclude(get_project_charges_filter())
     queryset = queryset.annotate(
         remote=Case(When(remote_work=True, then=True), default=False, output_field=BooleanField())
     )
+    queryset = queryset.annotate(customer_id=F("user_id"))
     if get_core_facility() and get_core_facility().objects.exists():
         queryset = queryset.annotate(
             core_facility_id=F("tool__core_rel__core_facility"),
             core_facility_name=F("tool__core_rel__core_facility__name"),
         )
     return queryset
 
@@ -286,26 +288,28 @@
     return queryset
 
 
 def training_sessions(start, end) -> QuerySetType[TrainingSession]:
     queryset = TrainingSession.objects.filter(date__date__gte=start, date__date__lte=end)
     queryset = queryset.exclude(get_project_charges_filter())
     queryset = queryset.annotate(remote=Value(False, output_field=BooleanField()))
+    queryset = queryset.annotate(customer_id=F("trainee_id"))
     if get_core_facility() and get_core_facility().objects.exists():
         queryset = queryset.annotate(
             core_facility_id=F("tool__core_rel__core_facility"),
             core_facility_name=F("tool__core_rel__core_facility__name"),
         )
     return queryset
 
 
 def missed_reservations(start, end) -> QuerySetType[Reservation]:
     queryset = Reservation.objects.filter(missed=True, end__date__gte=start, end__date__lte=end)
     queryset = queryset.exclude(get_project_charges_filter())
     queryset = queryset.annotate(remote=Value(False, output_field=BooleanField()))
+    queryset = queryset.annotate(customer_id=F("user_id"))
     if get_core_facility() and get_core_facility().objects.exists():
         queryset = queryset.annotate(
             core_facility_id=Case(
                 When(tool__isnull=False, then=F("tool__core_rel__core_facility")),
                 When(area__isnull=False, then=F("area__core_rel__core_facility")),
                 default=None,
             ),
```

## NEMO_reports/views/reporting_facilily_usage.py

```diff
@@ -1,10 +1,12 @@
 import datetime
 from typing import List, Union
 
+from NEMO.models import Area, Tool, User
+from NEMO.utilities import queryset_search_filter
 from django.contrib.auth.decorators import login_required, permission_required
 
 try:
     from NEMO.models import Discipline as ProjectDiscipline
 except:
     from NEMO.models import ProjectDiscipline
 
@@ -31,14 +33,16 @@
 
 from NEMO_reports.views.reporting import (
     ACTIVITIES_PARAMETER_LIST,
     DEFAULT_PARAMETER_LIST,
     DataDisplayTable,
     ReportingParameters,
     SummaryDisplayTable,
+    ITEM_PARAMETER,
+    USER_PARAMETER,
     area_access,
     get_core_facility,
     get_month_range,
     get_monthly_rule,
     get_rate_category,
     get_institution_type,
     get_institution,
@@ -51,20 +55,38 @@
     usage_events,
 )
 
 
 @login_required
 @permission_required(get_report_dict()["facility_usage"]["permission"])
 @require_GET
+def user_search(request):
+    return queryset_search_filter(User.objects.all(), ["first_name", "last_name", "username"], request)
+
+
+@login_required
+@permission_required(get_report_dict()["facility_usage"]["permission"])
+@require_GET
 def facility_usage(request):
-    param_names = DEFAULT_PARAMETER_LIST + ACTIVITIES_PARAMETER_LIST
+    param_names = DEFAULT_PARAMETER_LIST + ACTIVITIES_PARAMETER_LIST + USER_PARAMETER + ITEM_PARAMETER
     params = ReportingParameters(request, param_names)
     start, end = params.start, params.end
     split_by_month = params.get_bool("split_by_month")
     cumulative_count = params.get_bool("cumulative_count")
+    user_id = params.get_dict().get("user_id")
+    tool_id = params.get_dict().get("tool_id")
+    area_id = params.get_dict().get("area_id")
+    # Make sure we are not getting incompatible charge types with tool/area selection
+    if tool_id:
+        setattr(params, "area_access", "off")
+        setattr(params, "staff_charges", "off")
+    if area_id:
+        setattr(params, "tool_usage", "off")
+        setattr(params, "training", "off")
+        setattr(params, "staff_charges", "off")
     monthly_start = None
     if cumulative_count:
         split_by_month = True
         monthly_start, monthly_end = get_month_range(start)
 
     RateCategory = get_rate_category()
     CoreFacility = get_core_facility()
@@ -75,14 +97,15 @@
     if params.get_bool("detailed_data"):
         data.headers = [
             ("type", "Type"),
             ("user", "Username"),
             ("project", "Project"),
             ("start", "Start"),
             ("end", "End"),
+            ("item", "Item"),
             ("details", "Details"),
             ("duration", "Duration"),
             ("onsite", "On-site"),
         ]
 
         if CoreFacility and CoreFacility.objects.exists():
             data.add_header(("core_facility", "Core Facility"))
@@ -106,14 +129,15 @@
             data_row = {
                 "type": billable.type,
                 "user": billable.username,
                 "project": project or "N/A",
                 "start": billable.start,
                 "end": billable.end,
                 "details": billable.details,
+                "item": billable.name if billable.type != "staff_charge" else None,
                 "duration": billable.timedelta,
                 "onsite": not billable.remote,
                 "core_facility": billable.core_facility,
                 "discipline": project.discipline.name if project and project.discipline else "N/A",
                 "account_type": project.account.type.name if project and project.account.type else "N/A",
                 "institution_name": institution.name if institution else "N/A",
                 "institution_type": (
@@ -168,14 +192,19 @@
     else:
         summary.add_header(("value", "Value"))
         add_summary_info(params, summary, start, end)
 
     if params.get_bool("export"):
         return report_export([summary, data], "facility_usage", start, end)
     dictionary = {
+        "tool_list": Tool.objects.all(),
+        "area_list": Area.objects.all(),
+        "selected_user": User.objects.get(id=user_id) if user_id else None,
+        "selected_tool": Tool.objects.get(id=tool_id) if tool_id else None,
+        "selected_area": Area.objects.get(id=area_id) if area_id else None,
         "data": data,
         "summary": summary,
     }
     return render(
         request,
         "NEMO_reports/report_facility_usage.html",
         reporting_dictionary("facility_usage", params, dictionary),
@@ -264,54 +293,71 @@
     summary.rows[current_row][summary_key] = onsite_duration
 
 
 def get_facility_usage_duration_and_data(
     params: ReportingParameters,
     start: datetime.datetime,
     end: datetime.datetime,
-    extra_filter: Q = None,
+    extra_filter: Q = Q(),
     data: bool = False,
 ) -> (datetime.timedelta, List[BillableItem]):
     # Returns total duration and data (if the data parameter is True)
     # This allows us to use filtering and aggregate and speed up the process
     # greatly if individual data is not needed.
     total_duration = datetime.timedelta(0)
     billables = []
+    user_id = params.get_dict().get("user_id")
+    tool_id = params.get_dict().get("tool_id")
+    area_id = params.get_dict().get("area_id")
+    if user_id:
+        extra_filter &= Q(customer_id=user_id)
     if params.get_bool("tool_usage", "on"):
         tool_usages = usage_events(start, end).annotate(timedelta=F("end") - F("start"))
         if extra_filter:
             tool_usages = tool_usages.filter(extra_filter)
+        if tool_id:
+            tool_usages = tool_usages.filter(tool_id=tool_id)
         total_duration += tool_usages.aggregate(Sum("timedelta"))["timedelta__sum"] or datetime.timedelta(0)
         if data:
             billables.extend(map(to_billable_items, tool_usages))
     if params.get_bool("area_access", "on"):
         area_records = area_access(start, end).annotate(timedelta=F("end") - F("start"))
         if extra_filter:
             area_records = area_records.filter(extra_filter)
+        if area_id:
+            area_records = area_records.filter(area_id=area_id)
         total_duration += area_records.aggregate(Sum("timedelta"))["timedelta__sum"] or datetime.timedelta(0)
         if data:
             billables.extend(map(to_billable_items, area_records))
     if params.get_bool("staff_charges", "on"):
         staff_work = staff_charges(start, end).annotate(timedelta=F("end") - F("start"))
         if extra_filter:
             staff_work = staff_work.filter(extra_filter)
         total_duration += staff_work.aggregate(Sum("timedelta"))["timedelta__sum"] or datetime.timedelta(0)
         if data:
             billables.extend(map(to_billable_items, staff_work))
     if params.get_bool("training", "on"):
         trainings = training_sessions(start, end)
         if extra_filter:
             trainings = trainings.filter(extra_filter)
+        if tool_id:
+            trainings = trainings.filter(tool_id=tool_id)
         total_duration += datetime.timedelta(minutes=trainings.aggregate(Sum("duration"))["duration__sum"] or 0)
         if data:
             billables.extend(map(to_billable_items, trainings))
     if params.get_bool("missed_reservations", "on"):
         reservations = missed_reservations(start, end).annotate(timedelta=F("end") - F("start"))
         if extra_filter:
             reservations = reservations.filter(extra_filter)
+        if tool_id and area_id:
+            reservations = reservations.filter(Q(tool_id=tool_id) | Q(area_id=area_id))
+        elif tool_id:
+            reservations = reservations.filter(tool_id=tool_id)
+        elif area_id:
+            reservations = reservations.filter(area_id=area_id)
         total_duration += reservations.aggregate(Sum("timedelta"))["timedelta__sum"] or datetime.timedelta(0)
         if data:
             billables.extend(map(to_billable_items, reservations))
     return total_duration, billables
 
 
 def to_billable_items(
```

## Comparing `NEMO_reports-1.8.0.dist-info/LICENSE` & `NEMO_reports-1.8.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `NEMO_reports-1.8.0.dist-info/METADATA` & `NEMO_reports-1.8.1.dist-info/METADATA`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: NEMO-reports
-Version: 1.8.0
+Version: 1.8.1
 Summary: Reports plugin for NEMO
 Home-page: https://gitlab.com/nemo-community/atlantis-labs/nemo-reports
 Author: Atlantis Labs LLC
 Author-email: atlantis@atlantislabs.io
 License: MIT
 Keywords: NEMO
 Classifier: Development Status :: 5 - Production/Stable
```

## Comparing `NEMO_reports-1.8.0.dist-info/RECORD` & `NEMO_reports-1.8.1.dist-info/RECORD`

 * *Files 9% similar despite different names*

```diff
@@ -1,39 +1,39 @@
 NEMO_reports/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 NEMO_reports/app_settings.py,sha256=3uw9TvMBQfxlnRegGbCOGR4mkfUG8o7zxE5IbmYpkOo,41
 NEMO_reports/apps.py,sha256=c-Z_5mWDOIEFwV1pp7Q1E4W6aLuEzGHqyXHHF04z6iM,486
 NEMO_reports/customizations.py,sha256=n9wN2zsxnIHKVkj6GKWDbqPtQkUpn24nbnd5YhWsYAc,1732
 NEMO_reports/models.py,sha256=n0aljvPXNpIxi91vfCZfydFP-NdF4Z115KF6liECTsc,348
-NEMO_reports/urls.py,sha256=VYCjNJiGny4DFnScJu542XtZQ4M0ZAUrN7gUrUMD7jM,1620
+NEMO_reports/urls.py,sha256=KXAbejAIAOzbVMBiRHJd2qkeUdxjDmvmRkPjDP8BBQQ,1834
 NEMO_reports/migrations/0001_initial.py,sha256=JjjAh6Q27qXgo88GYehRAbiyscj_r6biQ29b4np2_Vw,1264
 NEMO_reports/migrations/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 NEMO_reports/static/NEMO_reports/NEMO_reports.css,sha256=H33WpNNP5RylVlaIldjgNCrYj5U9J4zGS6IPkf6NvMU,243
 NEMO_reports/static/NEMO_reports/daterangepicker.css,sha256=9e9MfmRHWQmp4yMV-R9cxXU6-ZjzB2x-YcE4Z1Kmuag,7659
 NEMO_reports/static/NEMO_reports/daterangepicker.js,sha256=nCVry5qhDvfmuraDoHeq7bv91trY3tpPHnq_T3_hBOw,66305
 NEMO_reports/templates/NEMO_reports/report_active_users.html,sha256=_FKiR0hHrDso3mEz9VvG2xTWYwoLj7S2wLyh2KTp7Ps,3603
 NEMO_reports/templates/NEMO_reports/report_base.html,sha256=GVXBftw3Y_gMt8qtXmQYcVPpHK7Gh7z3Q21DtQwwB58,9524
-NEMO_reports/templates/NEMO_reports/report_facility_usage.html,sha256=LhQLkYKT1h5Ez57M6YHKh2DHPiJE5xHvnv0fNripFyU,2557
+NEMO_reports/templates/NEMO_reports/report_facility_usage.html,sha256=YTn1oyrJ0nyrg-SckPKDOsyUBO4CvZ8qzGsLiU84uRI,7835
 NEMO_reports/templates/NEMO_reports/report_new_users.html,sha256=qiwgHL08t4eFbV2wSxn6zjpaaibZMbLriO4mgE0LqgI,4174
 NEMO_reports/templates/NEMO_reports/reports.html,sha256=UM40R3zmj1piL1TP6TUjCQMbQCHxZWxf_uN69ARXq1c,1049
 NEMO_reports/templates/base/navbar.html,sha256=-0IToNIgmOlOWAu2azUdyngoPLx-5MEEDKT5h4DoC1c,287
 NEMO_reports/templates/base/navbar_reports.html,sha256=QYbguLQplOc-WSB5fXLTZveGbmHLVEmkO3El5mDsgFc,134
 NEMO_reports/templates/customizations/customizations_reports.html,sha256=DScmXeQU_6rMrSyFRfkSCdn89SVAgILWecPKo85euYg,7129
 NEMO_reports/templatetags/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 NEMO_reports/templatetags/reports_tags.py,sha256=Fj4OdRbj0EWBBDsWlPJPerBdI7LBlSFfN4Q2KhxShQ4,308
 NEMO_reports/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 NEMO_reports/tests/test_settings.py,sha256=THrnkxrBo5RJ6ihFhkXJgE478xk1YXnspgnNRM1yg3U,2863
 NEMO_reports/tests/test_settings_with_billing.py,sha256=5m645Yj_723-WSzgiUxr46UbgKek6hdXOgCE1ocoTFs,257
-NEMO_reports/tests/test_utilities.py,sha256=i7IyP8X4NITuAZxFMZu3liSGonDlZBuzNRqu67N14v4,256
+NEMO_reports/tests/test_utilities.py,sha256=7xb6VzoIWHfm3qtEPNtGiBycwRkPDm1Tfd43yF057cM,263
 NEMO_reports/tests/test_reports/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-NEMO_reports/tests/test_reports/test_reports.py,sha256=SmDzZUyB6QClKtAxmnge6HM-XdUCPpepezfnnS7agVQ,3749
+NEMO_reports/tests/test_reports/test_reports.py,sha256=t6T7McO9QyzoXRKJ3f6GNujdzfhD-Wip0U8PPHBH0T4,4060
 NEMO_reports/views/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-NEMO_reports/views/reporting.py,sha256=RZ_IVTVKLd9lFpLOqrvtiJdtlSZ46nZL5ctU-YUsdqk,19212
-NEMO_reports/views/reporting_facilily_usage.py,sha256=2Go_G_40QBCZuAAgHnb59hvBU_jRANjeZYD0arGEPQc,15173
+NEMO_reports/views/reporting.py,sha256=otThMLPCV6CF3Iv_yNShmXl-hd4zRhjzFQU4gg25y_Q,19435
+NEMO_reports/views/reporting_facilily_usage.py,sha256=UcwrDP_FWpD-5v2_mwLmF-09VU4_0-Ygl_lnqAsHcNE,17223
 NEMO_reports/views/reporting_invoice_charges.py,sha256=_rUN2CVdnOPJIJ7kpCSKRZ8ILTGn3CxVBjvvvqtFvGs,12326
 NEMO_reports/views/reporting_invoice_item_charges.py,sha256=D4xML-Qic-wEtACvGdJgRKDnRvyXbRya7Rwrw7RYmjM,16322
 NEMO_reports/views/reporting_new_user_activities.py,sha256=X52ulcWzgrc3vHxi4ON-ZsVJo_n_agM0WtV2YBx-Osw,24972
 NEMO_reports/views/reporting_unique_user_prj_acc.py,sha256=fsu6jcEHam9PqjZiLxV_eP1vecUoHQbgkmUNw-2nKyY,15577
-NEMO_reports-1.8.0.dist-info/LICENSE,sha256=wFCCmLGvBMU6-W_0h08WYEs3cFtVstutDmY5AzKppQc,1074
-NEMO_reports-1.8.0.dist-info/METADATA,sha256=jB7glGRn4VYr4vU4HIWwCFtpi51CHpX1sIn8OHOX9Ko,2116
-NEMO_reports-1.8.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-NEMO_reports-1.8.0.dist-info/top_level.txt,sha256=6Sq8v68WbH9DkCJMuHLlx3cf2SXldad5VA_yGcd1Xl4,13
-NEMO_reports-1.8.0.dist-info/RECORD,,
+NEMO_reports-1.8.1.dist-info/LICENSE,sha256=wFCCmLGvBMU6-W_0h08WYEs3cFtVstutDmY5AzKppQc,1074
+NEMO_reports-1.8.1.dist-info/METADATA,sha256=xVAMK0j9dJKdHjaMmcPZFC1mui92ESlabhkjuLZts4o,2116
+NEMO_reports-1.8.1.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+NEMO_reports-1.8.1.dist-info/top_level.txt,sha256=6Sq8v68WbH9DkCJMuHLlx3cf2SXldad5VA_yGcd1Xl4,13
+NEMO_reports-1.8.1.dist-info/RECORD,,
```

