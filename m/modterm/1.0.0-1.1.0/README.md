# Comparing `tmp/modterm-1.0.0-py3-none-any.whl.zip` & `tmp/modterm-1.1.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,24 +1,25 @@
-Zip file size: 38753 bytes, number of entries: 22
--rw-r--r--  2.0 unx       22 b- defN 24-Feb-03 10:09 modterm/__init__.py
--rw-r--r--  2.0 unx     5599 b- defN 24-Feb-03 10:09 modterm/__main__.py
--rw-r--r--  2.0 unx        0 b- defN 24-Feb-03 10:09 modterm/components/__init__.py
--rw-r--r--  2.0 unx     5532 b- defN 24-Feb-03 10:09 modterm/components/config_handler.py
--rw-r--r--  2.0 unx     3023 b- defN 24-Feb-03 10:09 modterm/components/definitions.py
--rw-r--r--  2.0 unx     6992 b- defN 24-Feb-03 10:09 modterm/components/header_menu.py
--rw-r--r--  2.0 unx     1382 b- defN 24-Feb-03 10:09 modterm/components/help.py
--rw-r--r--  2.0 unx     1243 b- defN 24-Feb-03 10:09 modterm/components/hepers.py
--rw-r--r--  2.0 unx    15523 b- defN 24-Feb-03 10:09 modterm/components/modbus_handler.py
--rw-r--r--  2.0 unx      853 b- defN 24-Feb-03 10:09 modterm/components/popup_message.py
--rw-r--r--  2.0 unx     6170 b- defN 24-Feb-03 10:09 modterm/components/read_registers_menu.py
--rw-r--r--  2.0 unx     6771 b- defN 24-Feb-03 10:09 modterm/components/scrollable_list.py
--rw-r--r--  2.0 unx     1708 b- defN 24-Feb-03 10:09 modterm/components/serial_interface_scan.py
--rw-r--r--  2.0 unx     7363 b- defN 24-Feb-03 10:09 modterm/components/unit_sweep_menu.py
--rw-r--r--  2.0 unx     2658 b- defN 24-Feb-03 10:09 modterm/components/window_base.py
--rw-r--r--  2.0 unx     5743 b- defN 24-Feb-03 10:09 modterm/components/write_registers_menu.py
--rw-r--r--  2.0 unx    35149 b- defN 24-Feb-03 10:10 modterm-1.0.0.dist-info/LICENSE.txt
--rw-r--r--  2.0 unx     4324 b- defN 24-Feb-03 10:10 modterm-1.0.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Feb-03 10:10 modterm-1.0.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       50 b- defN 24-Feb-03 10:10 modterm-1.0.0.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        8 b- defN 24-Feb-03 10:10 modterm-1.0.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1920 b- defN 24-Feb-03 10:10 modterm-1.0.0.dist-info/RECORD
-22 files, 112125 bytes uncompressed, 35597 bytes compressed:  68.3%
+Zip file size: 40787 bytes, number of entries: 23
+-rw-r--r--  2.0 unx       22 b- defN 24-May-27 21:22 modterm/__init__.py
+-rw-r--r--  2.0 unx     6147 b- defN 24-May-27 21:22 modterm/__main__.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-27 21:22 modterm/components/__init__.py
+-rw-r--r--  2.0 unx     6218 b- defN 24-May-27 21:22 modterm/components/config_handler.py
+-rw-r--r--  2.0 unx     3380 b- defN 24-May-27 21:22 modterm/components/definitions.py
+-rw-r--r--  2.0 unx     5440 b- defN 24-May-27 21:22 modterm/components/export_menu.py
+-rw-r--r--  2.0 unx     6992 b- defN 24-May-27 21:22 modterm/components/header_menu.py
+-rw-r--r--  2.0 unx     1413 b- defN 24-May-27 21:22 modterm/components/help.py
+-rw-r--r--  2.0 unx     1243 b- defN 24-May-27 21:22 modterm/components/hepers.py
+-rw-r--r--  2.0 unx    15523 b- defN 24-May-27 21:22 modterm/components/modbus_handler.py
+-rw-r--r--  2.0 unx      853 b- defN 24-May-27 21:22 modterm/components/popup_message.py
+-rw-r--r--  2.0 unx     6170 b- defN 24-May-27 21:22 modterm/components/read_registers_menu.py
+-rw-r--r--  2.0 unx     6771 b- defN 24-May-27 21:22 modterm/components/scrollable_list.py
+-rw-r--r--  2.0 unx     1708 b- defN 24-May-27 21:22 modterm/components/serial_interface_scan.py
+-rw-r--r--  2.0 unx     7382 b- defN 24-May-27 21:22 modterm/components/unit_sweep_menu.py
+-rw-r--r--  2.0 unx     2658 b- defN 24-May-27 21:22 modterm/components/window_base.py
+-rw-r--r--  2.0 unx     5743 b- defN 24-May-27 21:22 modterm/components/write_registers_menu.py
+-rw-r--r--  2.0 unx    35149 b- defN 24-May-27 21:22 modterm-1.1.0.dist-info/LICENSE.txt
+-rw-r--r--  2.0 unx     4324 b- defN 24-May-27 21:22 modterm-1.1.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-27 21:22 modterm-1.1.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       50 b- defN 24-May-27 21:22 modterm-1.1.0.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        8 b- defN 24-May-27 21:22 modterm-1.1.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2010 b- defN 24-May-27 21:22 modterm-1.1.0.dist-info/RECORD
+23 files, 119296 bytes uncompressed, 37489 bytes compressed:  68.6%
```

## zipnote {}

```diff
@@ -9,14 +9,17 @@
 
 Filename: modterm/components/config_handler.py
 Comment: 
 
 Filename: modterm/components/definitions.py
 Comment: 
 
+Filename: modterm/components/export_menu.py
+Comment: 
+
 Filename: modterm/components/header_menu.py
 Comment: 
 
 Filename: modterm/components/help.py
 Comment: 
 
 Filename: modterm/components/hepers.py
@@ -42,26 +45,26 @@
 
 Filename: modterm/components/window_base.py
 Comment: 
 
 Filename: modterm/components/write_registers_menu.py
 Comment: 
 
-Filename: modterm-1.0.0.dist-info/LICENSE.txt
+Filename: modterm-1.1.0.dist-info/LICENSE.txt
 Comment: 
 
-Filename: modterm-1.0.0.dist-info/METADATA
+Filename: modterm-1.1.0.dist-info/METADATA
 Comment: 
 
-Filename: modterm-1.0.0.dist-info/WHEEL
+Filename: modterm-1.1.0.dist-info/WHEEL
 Comment: 
 
-Filename: modterm-1.0.0.dist-info/entry_points.txt
+Filename: modterm-1.1.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: modterm-1.0.0.dist-info/top_level.txt
+Filename: modterm-1.1.0.dist-info/top_level.txt
 Comment: 
 
-Filename: modterm-1.0.0.dist-info/RECORD
+Filename: modterm-1.1.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## modterm/__init__.py

```diff
@@ -1 +1 @@
-__version__ = "1.0.0"
+__version__ = "1.1.0"
```

## modterm/__main__.py

```diff
@@ -14,15 +14,17 @@
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
 along with this program. If not, see <https://www.gnu.org/licenses/>.
 """
 
 import curses
+import os.path
 import sys
+import time
 from os import environ, path
 import logging
 from logging.handlers import RotatingFileHandler
 from modterm.components.config_handler import save_modbus_config, load_read_config, get_project_dir
 
 logger = logging.getLogger("ModTerm")
 logger.setLevel('INFO')
@@ -41,14 +43,15 @@
 from modterm.components.help import display_help
 from modterm.components.scrollable_list import ScrollableList
 from modterm.components.header_menu import HeaderMenu
 from modterm.components.read_registers_menu import ReadRegistersMenu
 from modterm.components.write_registers_menu import WriteRegistersMenu
 from modterm.components.unit_sweep_menu import UnitSweepMenu
 from modterm.components.popup_message import show_popup_message
+from modterm.components.export_menu import ExportMenu
 
 
 def app(screen):
     screen.keypad(1)
     curses.init_pair(1, curses.COLOR_BLACK, curses.COLOR_CYAN)
     highlighted_text = curses.color_pair(1)
     normal_text = curses.A_NORMAL
@@ -97,21 +100,28 @@
             unit_sweep_menu = UnitSweepMenu(screen, normal_text, highlighted_text)
             if unit_sweep_menu.is_valid:
                 table_data = unit_sweep_menu.sweep_units(modbus_config=menu.configuration)
                 if table_data is not None:
                     data_window.draw(table_data)
                     modbus_handler = unit_sweep_menu.modbus_handler
                 save_modbus_config(menu.configuration)
-
+        if x == ord("e"):
+            if data_window.header is None or len(data_window.data_rows) == 0:
+                show_popup_message(screen, width=40, title="Error",
+                                   message="Nothing to export!")
+            else:
+                export_menu = ExportMenu(screen, normal_text, highlighted_text, data_window.header, data_window.data_rows)
+                if export_menu.is_valid:
+                    export_menu.export_dialog()
         menu.draw()
         try:
             data_window.draw()
         except Exception:
             logger.critical("Failed to draw data window!", exc_info=True)
-            show_popup_message(screen, width=40, title="Error", message="Failed to draw data window! Please refer to the log for details and repor any software issues.")
+            show_popup_message(screen, width=40, title="Error", message="Failed to draw data window! Please refer to the log for details and report any software issues.")
         # screen.addstr(screen.getmaxyx()[0] - 1, screen.getmaxyx()[1] - 4, str(x))
         screen.refresh()
         x = screen.getch()
 
 
 def main():
     rc = 0
```

## modterm/components/config_handler.py

```diff
@@ -21,15 +21,15 @@
 from typing import Optional, Union, Type
 from dataclasses import asdict
 import os
 import sys
 from pathlib import Path
 from json import loads, dumps
 from modterm.components.definitions import CONFIG_DIR, ConfigType, ModbusConfig, ReadConfig, WriteConfig, \
-                                           UnitSweepConfig
+    UnitSweepConfig, ExportConfig
 
 
 class ConfigOperation(Enum):
     LOAD = "Load"
     SAVE = "Save"
 
 
@@ -56,22 +56,25 @@
 
 
 def config_file_manager(action: ConfigOperation,
                         config_type: ConfigType,
                         config_class: Optional[Union[Type[ModbusConfig],
                                                      Type[ReadConfig],
                                                      Type[WriteConfig],
-                                                     Type[UnitSweepConfig]]] = None,
+                                                     Type[UnitSweepConfig],
+                                                     Type[ExportConfig]]] = None,
                         config_to_save: Optional[Union[ModbusConfig,
                                                        ReadConfig,
                                                        WriteConfig,
-                                                       UnitSweepConfig]] = None) -> Optional[Union[ModbusConfig,
-                                                                                                   ReadConfig,
-                                                                                                   WriteConfig,
-                                                                                                   UnitSweepConfig]]:
+                                                       UnitSweepConfig,
+                                                       ExportConfig]] = None) -> Optional[Union[ModbusConfig,
+                                                                                                ReadConfig,
+                                                                                                WriteConfig,
+                                                                                                UnitSweepConfig,
+                                                                                                ExportConfig]]:
 
     if (config_dir := get_project_dir()) is None:
         # TODO log error
         return None
 
     if not os.path.isdir(config_dir):
         os.makedirs(config_dir)
@@ -81,15 +84,15 @@
     if action == ConfigOperation.LOAD:
         if not os.path.isfile(config_file):
             loaded_config = {}
         try:
             with open(config_file, "r") as configfile:
                 loaded_config: dict = loads(configfile.read())
         except Exception as e:
-            # TODO log
+            loaded_config = {}
             pass
         return config_class.from_dict(loaded_config)
     else:
         if config_to_save is None:
             return None
         with open(config_file, "w") as configfile:
             configfile.write(dumps(asdict(config_to_save)))
@@ -137,7 +140,19 @@
                                config_class=UnitSweepConfig)
 
 
 def save_unit_sweep_config(config: UnitSweepConfig):
     return config_file_manager(action=ConfigOperation.SAVE,
                                config_type=ConfigType.UnitSweepConfig,
                                config_to_save=config)
+
+
+def save_export_config(config: ExportConfig):
+    return config_file_manager(action=ConfigOperation.SAVE,
+                               config_type=ConfigType.ExportConfig,
+                               config_to_save=config)
+
+
+def load_export_config() -> ExportConfig:
+    return config_file_manager(action=ConfigOperation.LOAD,
+                               config_type=ConfigType.ExportConfig,
+                               config_class=ExportConfig)
```

## modterm/components/definitions.py

```diff
@@ -45,14 +45,15 @@
 
 
 class ConfigType(Enum):
     ModbusConfig = "modbus_config.conf"
     ReadConfig = "read_config.conf"
     WriteConfig = "write_config.conf"
     UnitSweepConfig = "scan_config.conf"
+    ExportConfig = "export.conf"
 
 
 @dataclass
 class ModbusConfig:
     mode: str = TCP
     ip: str = "localhost"
     port: int = 502
@@ -98,14 +99,28 @@
 
     @classmethod
     def from_dict(cls, config_dict):
         return cls(**{
             k: v for k, v in config_dict.items()
             if k in inspect.signature(cls).parameters
         })
+
+
+@dataclass
+class ExportConfig:
+    last_dir: Optional[str] = None
+    last_file_name: str = None
+    last_file_type: str = ".csv"
+
+    @classmethod
+    def from_dict(cls, config_dict):
+        return cls(**{
+            k: v for k, v in config_dict.items()
+            if k in inspect.signature(cls).parameters
+        })
 
 
 @dataclass
 class UnitSweepConfig:
     start_unit: int = 1
     last_unit: int = 255
     command: str = HOLDING
```

## modterm/components/help.py

```diff
@@ -26,14 +26,15 @@
     "Quit application: F10",
     "Top menu items: F keys as indicated",
     "",
     "Register operations",
     "r - Read registers",
     "w - Write registers",
     "s - Sweep modbus units with register reads",
+    "e - Export register data"
     # "i - Sweep IP addresses with register reads",
 ]
 
 def display_help(screen):
     help_window = WindowBase(screen, 20, 80, title="Help")
     help_window.draw_window()
     for idx, row in enumerate(help_text_rows, start=1):
```

## modterm/components/unit_sweep_menu.py

```diff
@@ -51,15 +51,15 @@
         self.dialog.window.addstr(5, 2, f"F5 - Start unit ID: {self.configuration.start_unit}")
         self.dialog.window.addstr(6, 2, f"F6 - Last unit ID: {self.configuration.last_unit}")
         self.dialog.window.addstr(7, 2, f"F7 - Timeeout: {self.configuration.timeout}")
         self.dialog.window.addstr(9, 2, f"Press ENTER to start reading, ESC to interrupt the running process")
         self.dialog.window.refresh()
 
     def add_status_text(self, text):
-        if self.status_index == 39:
+        if self.status_index == self.max_status_index:
             self.dialog.window.clear()
             self.draw()
             self.status_index = 11
         self.dialog.window.addstr(self.status_index, 2, text)
         self.status_index += 1
         self.dialog.window.refresh()
```

## Comparing `modterm-1.0.0.dist-info/LICENSE.txt` & `modterm-1.1.0.dist-info/LICENSE.txt`

 * *Files identical despite different names*

## Comparing `modterm-1.0.0.dist-info/METADATA` & `modterm-1.1.0.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: modterm
-Version: 1.0.0
+Version: 1.1.0
 Summary: A modbus analyser written in pure Python
 Author-email: Máté Szabó <mate@mateszabo.com>
 Project-URL: Homepage, https://github.com/matesh/modterm
 Project-URL: Issues, https://github.com/matesh/modterm/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
 Classifier: Operating System :: OS Independent
```

## Comparing `modterm-1.0.0.dist-info/RECORD` & `modterm-1.1.0.dist-info/RECORD`

 * *Files 16% similar despite different names*

```diff
@@ -1,22 +1,23 @@
-modterm/__init__.py,sha256=J-j-u0itpEFT6irdmWmixQqYMadNl1X91TxUmoiLHMI,22
-modterm/__main__.py,sha256=o0xvYhho_p0T5pGglXfehyKyQPFB1G2i-FuvnV2bpd0,5599
+modterm/__init__.py,sha256=LGVQyDsWifdACo7qztwb8RWWHds1E7uQ-ZqD8SAjyw4,22
+modterm/__main__.py,sha256=RarSZHTFAZ_GKB_1HKyxINw7aNoMaN0M5-Q8_DcPbGM,6147
 modterm/components/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-modterm/components/config_handler.py,sha256=GHEVa_3b_75Ou-4wkVRGq-j8PNk9Ts5Xn3c6L_DDiXg,5532
-modterm/components/definitions.py,sha256=bGX6qKjAdyNOM8GmpF3swucvflWqM5mWaw2wub9K95U,3023
+modterm/components/config_handler.py,sha256=tWfhOHiHoxk0jBKHkGEyPN683e4BHoRThSbUQYTI6hc,6218
+modterm/components/definitions.py,sha256=NpdruJjEsFdNbW4VcLQJHtAgchhhmdY262K6-8PnJC8,3380
+modterm/components/export_menu.py,sha256=DyV5-_XY7mU0hC8HDL0UbrhPvyQDDSyXyU4j8VuRC8Y,5440
 modterm/components/header_menu.py,sha256=B1yJpAxgJcl9U7LwcPpgYhcbU2fiLhaNUy-c4WKjK5M,6992
-modterm/components/help.py,sha256=x-JxCAIhA2HWq5sHlGLPzyD9KoZmDUouM1wMGKRQHgQ,1382
+modterm/components/help.py,sha256=v6nqSZDKtUy_Y5KhvkdrSNTNX1L7jzsw-Cqh5ORVhcc,1413
 modterm/components/hepers.py,sha256=hdwuLYRU9Jms-K4xNRV5T6AeQDu3b3iuBwicoRoU0jo,1243
 modterm/components/modbus_handler.py,sha256=iD80Lia1HIoPdwhv85zQ0o0tXWiRUSG84HMqdRGbWGw,15523
 modterm/components/popup_message.py,sha256=3G8YSAVOhIJVw3zmkiohgelAUoXqJRQivRMQ63evEzk,853
 modterm/components/read_registers_menu.py,sha256=2a8ryBLj1daqGdOdD-9uF7iVqJKglOI-UUtAnTWg7IA,6170
 modterm/components/scrollable_list.py,sha256=D06ddOsObKu-2R2eQot3VWNERAaLTKV5DAawegGTwWc,6771
 modterm/components/serial_interface_scan.py,sha256=8lqBtdJ5uBR6yjYe8czVH6hfVoDfVaeAzlh0t9-udVg,1708
-modterm/components/unit_sweep_menu.py,sha256=UwktTZBNojya3IxZWDTEpEfSCxsEzpLBlCT5sGv2aEA,7363
+modterm/components/unit_sweep_menu.py,sha256=dPchA4F2N_HI3ChnNevCGfcxSOrhPp-JAHGqi3Q-7J4,7382
 modterm/components/window_base.py,sha256=hQryMWxxWyghzb4JLAUXU9e7tiLBKsIWM8wbJ-HCaWo,2658
 modterm/components/write_registers_menu.py,sha256=5FGySL3htTl19xUNbwtgKXZ2PSvyp0io8lCbV7J8pYw,5743
-modterm-1.0.0.dist-info/LICENSE.txt,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
-modterm-1.0.0.dist-info/METADATA,sha256=z_ngv1QNXrXxz1hVBoxNSevt_A1Gj0VQlstWNtJd-H0,4324
-modterm-1.0.0.dist-info/WHEEL,sha256=oiQVh_5PnQM0E3gPdiz09WCNmwiHDMaGer_elqB3coM,92
-modterm-1.0.0.dist-info/entry_points.txt,sha256=RoeS5Ua4Lianjs2ATmrtU-m7_bZqnbtk5C21iRHPOHA,50
-modterm-1.0.0.dist-info/top_level.txt,sha256=a2_Cs9LUYk9dfhcz9sJex5Bz_KBZa61IIh240N79rCg,8
-modterm-1.0.0.dist-info/RECORD,,
+modterm-1.1.0.dist-info/LICENSE.txt,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
+modterm-1.1.0.dist-info/METADATA,sha256=CEmlbMpTEOW8RtTGUfrOHvmJujtEo2mrmBXzIUAQB08,4324
+modterm-1.1.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+modterm-1.1.0.dist-info/entry_points.txt,sha256=RoeS5Ua4Lianjs2ATmrtU-m7_bZqnbtk5C21iRHPOHA,50
+modterm-1.1.0.dist-info/top_level.txt,sha256=a2_Cs9LUYk9dfhcz9sJex5Bz_KBZa61IIh240N79rCg,8
+modterm-1.1.0.dist-info/RECORD,,
```

